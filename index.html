<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>தமிழ் வினாடி-வினா களஞ்சியம்</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background-color: #f0f2f5; margin: 0; padding: 20px; display: flex; justify-content: center; }
        .quiz-container { background: white; width: 100%; max-width: 600px; padding: 25px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        h1 { color: #1a73e8; text-align: center; font-size: 24px; }
        .meta-info { background: #e8f0fe; padding: 10px; border-radius: 8px; margin-bottom: 20px; border-left: 5px solid #1a73e8; }
        .question-box { margin-bottom: 20px; }
        .option-btn { display: block; width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #dadce0; border-radius: 8px; background: white; cursor: pointer; text-align: left; font-size: 16px; transition: 0.2s; }
        .option-btn:hover { background-color: #f8f9fa; border-color: #1a73e8; }
        .correct { background-color: #d4edda !important; border-color: #28a745 !important; }
        .wrong { background-color: #f8d7da !important; border-color: #dc3545 !important; }
        .btn-next { background: #1a73e8; color: white; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; width: 100%; font-size: 16px; margin-top: 10px; }
        #score-board { text-align: center; font-weight: bold; margin-bottom: 10px; color: #5f6368; }
    </style>
</head>
<body>

<div class="quiz-container">
    <h1>தமிழ் வினாடி-வினா</h1>
    <div id="score-board">சரியான பதில்கள்: <span id="score">0</span> / <span id="total">0</span></div>
    
    <div id="quiz-ui" style="display:none;">
        <div class="meta-info">
            <div id="cat-name" style="font-weight: bold; color: #1a73e8;"></div>
            <div id="quiz-title" style="font-size: 14px; margin-top: 4px;"></div>
        </div>
        <div class="question-box">
            <h3 id="q-text">வினா ஏற்றப்படுகிறது...</h3>
            <div id="options-area"></div>
        </div>
        <button id="next-quiz-btn" class="btn-next" onclick="pickRandomQuiz()" style="display:none;">அடுத்த ரேண்டம் வினாத்தாள்</button>
    </div>

    <div id="start-ui">
        <p style="text-align:center;">உங்கள் 30+ வினாத்தாள்களில் இருந்து தன்னிச்சையாக ஒன்று தேர்ந்தெடுக்கப்படும்.</p>
        <button class="btn-next" onclick="pickRandomQuiz()">தொடங்குக</button>
    </div>
</div>

<script src="data.js"></script>
<script>
    let score = 0;
    let totalQuestions = 0;

    async function pickRandomQuiz() {
        document.getElementById('start-ui').style.display = 'none';
        document.getElementById('quiz-ui').style.display = 'block';
        document.getElementById('next-quiz-btn').style.display = 'none';
        document.getElementById('options-area').innerHTML = "";
        document.getElementById('q-text').innerText = "வினாத்தாள் கிடைக்கிறது...";

        const category = masterData[Math.floor(Math.random() * masterData.length)];
        const quiz = category.quizzes[Math.floor(Math.random() * category.quizzes.length)];

        document.getElementById('cat-name').innerText = "பிரிவு: " + category.category;
        document.getElementById('quiz-title').innerText = "தலைப்பு: " + quiz.title;

        try {
            const res = await fetch(`questions/${quiz.file}`);
            const questions = await res.json();
            // வினாத்தாளிலிருந்து ஒரு ரேண்டம் வினாவை மட்டும் எடுக்கிறோம்
            const randomQ = questions[Math.floor(Math.random() * questions.length)];
            displayQuestion(randomQ);
        } catch (err) {
            document.getElementById('q-text').innerText = "கோப்பை ஏுற்றுவதில் பிழை: " + quiz.file;
        }
    }

    function displayQuestion(q) {
        document.getElementById('q-text').innerText = q.question;
        const optionsArea = document.getElementById('options-area');
        optionsArea.innerHTML = "";

        q.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt;
            btn.onclick = () => checkAnswer(btn, opt, q.answer);
            optionsArea.appendChild(btn);
        });
    }

    function checkAnswer(btn, selected, correct) {
        totalQuestions++;
        document.getElementById('total').innerText = totalQuestions;
        
        const allButtons = document.querySelectorAll('.option-btn');
        allButtons.forEach(b => b.disabled = true);

        if (selected === correct) {
            btn.classList.add('correct');
            score++;
            document.getElementById('score').innerText = score;
        } else {
            btn.classList.add('wrong');
            // சரியான விடையைக் காண்பிக்க
            allButtons.forEach(b => {
                if(b.innerText === correct) b.classList.add('correct');
            });
        }
        document.getElementById('next-quiz-btn').style.display = 'block';
    }
</script>
</body>
</html>
